{% extends "base.html" %}

{% block main_body %}
<main class="site-main">
  <section class="bubble bubble-lg" style="margin-bottom: 1rem;">
    <div class="bubble bubble-accent-navy" style="margin-bottom: 1em;">
    <h1 class="section-title" style="color:#e8f3fb">{{ content.title }}</h1>
    {% if content.subtitle %}
      <p class="section-subtitle" style="color:#c3c3c3">{{ content.subtitle }}</p>
    {% endif %}
    </div>
  </section>
  
  <div class="about-alt">
    {% for section in content.sections %}
      {% set side = 'left' if loop.index is odd else 'right' %}

      <section class="about-section {{ side }} bubble bubble-lg reveal">
        <h2 class="section-title">{{ section.title }}</h2>

        {% for b in section.blocks %}
          {% if b.kind == "body" and b.text %}
            <p>{{ b.text }}</p>

          {% elif b.kind in ["img","image"] %}
            {% set src = b.src or b.text %}
            {% if src %}
              <figure style="margin-top:.75rem;">
                <img src="{{ src }}" alt="{{ b.alt or section.title }}" loading="lazy">
                {% if b.alt %}<figcaption class="section-subtitle">{{ b.alt }}</figcaption>{% endif %}
              </figure>
            {% endif %}
          {% endif %}
        {% endfor %}
      </section>
    {% endfor %}
  </div>
</main>

<script>
  (function(){
    const els = document.querySelectorAll('.reveal');
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          e.target.classList.add('in-view');
          io.unobserve(e.target); // uncomment if you want one-time animation
        }
      });
    }, { threshold: 0.15, rootMargin: "0px 0px -10% 0px" });
    els.forEach(el => io.observe(el));
  })();
</script>
{% endblock %}
